{
    "name": "DF_Load_Fact_Visitor_Registration",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "ODS_Visitors",
                        "type": "DatasetReference"
                    },
                    "name": "source1"
                },
                {
                    "linkedService": {
                        "referenceName": "dwtc-bi-WorkspaceDefaultStorage",
                        "type": "LinkedServiceReference"
                    },
                    "name": "source2"
                },
                {
                    "dataset": {
                        "referenceName": "DimEvent",
                        "type": "DatasetReference"
                    },
                    "name": "DimEvent"
                },
                {
                    "dataset": {
                        "referenceName": "DIM_CONTACT_REGISTRATION",
                        "type": "DatasetReference"
                    },
                    "name": "DimContactReg"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "FACT_VISITOR_REGISTRATION",
                        "type": "DatasetReference"
                    },
                    "name": "sink1"
                }
            ],
            "transformations": [
                {
                    "name": "join1"
                },
                {
                    "name": "join2"
                },
                {
                    "name": "filter2"
                },
                {
                    "name": "filter3"
                },
                {
                    "name": "filter4"
                },
                {
                    "name": "filter5"
                },
                {
                    "name": "filter6"
                },
                {
                    "name": "join3"
                },
                {
                    "name": "join4"
                },
                {
                    "name": "select1"
                },
                {
                    "name": "select2"
                },
                {
                    "name": "select3"
                },
                {
                    "name": "select4"
                },
                {
                    "name": "join5"
                },
                {
                    "name": "select5"
                },
                {
                    "name": "derivedColumn1"
                },
                {
                    "name": "lookup1"
                },
                {
                    "name": "select6"
                },
                {
                    "name": "derivedColumn2"
                },
                {
                    "name": "lookup2"
                },
                {
                    "name": "flatten1"
                }
            ],
            "scriptLines": [
                "source(output(",
                "          id as string,",
                "          Index as string,",
                "          EventName as string,",
                "          FileName as string,",
                "          {2PM_Attendance} as string,",
                "          Attended as string,",
                "          Badge_Type as string,",
                "          Campaign as string,",
                "          Campaign_Source as string,",
                "          Cluster_Name as string,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING as string,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING as string,",
                "          Conference_Package_Third_Booking as string,",
                "          Cross_Over_Gates as string,",
                "          Cross_Over_Overall_Day as string,",
                "          Daily_Attendance as string,",
                "          Day_Selection as string,",
                "          DTCM_BASKETS as string,",
                "          DWTC_Booking_Platform as string,",
                "          DWTC_CRM_ID as string,",
                "          Event_ID as string,",
                "          Event_Year as string,",
                "          Exhibition_Halls as string,",
                "          Exhibition_Packages as string,",
                "          Exhibitor_Promo_Codes as string,",
                "          Exhibitor_Type as string,",
                "          Exhibitor_Account_ID as string,",
                "          Exhibitor_Name as string,",
                "          Facial_Recognition as string,",
                "          First_Booking_Paid_Packages as string,",
                "          GATE_SCANNERS as string,",
                "          Gates as string,",
                "          Generic_Package_Code_Exhibition_Conference as string,",
                "          ID_Verification as string,",
                "          Personal_Data_Consent as string,",
                "          Particulars_Given_Gov as string,",
                "          Majlis_Management as string,",
                "          Majlis_Nominating_Company as string,",
                "          Media_Geographical_Distribution as string,",
                "          MEDIA_LANGUAGE as string,",
                "          MEDIA_NAME as string,",
                "          MEDIA_TYPE as string,",
                "          MEDIA_TYPE_Other as string,",
                "          Medium as string,",
                "          Onsite_Stations as string,",
                "          Pass_Selection as string,",
                "          Pavilion as string,",
                "          PAY_Currency as string,",
                "          PAY_Mode as string,",
                "          PAY_Mode_Pack_2 as string,",
                "          PAY_Mode_Pack_3 as string,",
                "          PAY_Type as string,",
                "          Payment_Channel as string,",
                "          PAYMENT_CHOICE as string,",
                "          PAYMENT_CHOICE_PACK_2 as string,",
                "          PAYMENT_CHOICE_PACK_3 as string,",
                "          PAYMENT_DETAILS as string,",
                "          PAYMENT_DETAILS_PACK_2 as string,",
                "          PAYMENT_DETAILS_PACK_3 as string,",
                "          PAYMENT_STATUS as string,",
                "          PAYMENT_STATUS_PACK_1 as string,",
                "          PAYMENT_STATUS_PACK_2 as string,",
                "          PAYMENT_STATUS_PACK_3 as string,",
                "          Pre_POP_Codes as string,",
                "          Promo_Code as string,",
                "          Promo_Code_Discount_Ticketing_Price as string,",
                "          PS_Data as string,",
                "          PUBL_FREQ as string,",
                "          PUBL_FREQ_Other as string,",
                "          Publication as string,",
                "          Receipt_No as string,",
                "          Reg_Date as timestamp,",
                "          Reg_hall as string,",
                "          Reg_hall_Other as string,",
                "          Reg_Number as string,",
                "          Reg_Type as string,",
                "          Reg_Type_Other as string,",
                "          Second_Booking_Paid_Packages as string,",
                "          Self_Reg_Area as string,",
                "          Sessions_Attendance as string,",
                "          SHOW_NAME as string,",
                "          Stand_Number as string,",
                "          Student_ID as string,",
                "          Terms_Conditions as string,",
                "          Ticket_Selection as string,",
                "          Upgrade as string,",
                "          UTM_Values as string,",
                "          Verticals_Session as string,",
                "          VISITOR_TYPE as string,",
                "          VISITOR_TYPE_Other as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     isolationLevel: 'READ_UNCOMMITTED',",
                "     query: ' SELECT  [Index]+Filename as id\\n\\n,[Index]\\n,[EventName]\\n,[FileName]\\n,[2PM_Attendance] ,\\n[Attended] ,\\n[Badge_Type] ,\\n[Campaign] ,\\n[Campaign_Source] ,\\n[Cluster_Name] ,\\n[CONFERENCE_PACKAGE_FIRST_BOOKING] ,\\n[CONFERENCE_PACKAGE_SECOND_BOOKING] ,\\n[Conference_Package_Third_Booking] ,\\n[Cross_Over_Gates] ,\\n[Cross_Over_Overall_Day] ,\\n[Daily_Attendance] ,\\n[Day_Selection] ,\\n[DTCM_BASKETS] ,\\n[DWTC_Booking_Platform] ,\\n[DWTC_CRM_ID] ,\\n[Event_ID] ,\\n[Event_Year] ,\\n[Exhibition_Halls] ,\\n[Exhibition_Packages] ,\\n[Exhibitor_Promo_Codes] ,\\n[Exhibitor_Type] ,\\n[Exhibitor_Account_ID] ,\\n[Exhibitor_Name] ,\\n[Facial_Recognition] ,\\n[First_Booking_Paid_Packages] ,\\n[GATE_SCANNERS] ,\\n[Gates] ,\\n[Generic_Package_Code_Exhibition_Conference] ,\\n[ID_Verification] ,\\n[Personal_Data_Consent] ,\\n[Particulars_Given_Gov] ,\\n[Majlis_Management] ,\\n[Majlis_Nominating_Company] ,\\n[Media_Geographical_Distribution] ,\\n[MEDIA_LANGUAGE] ,\\n[MEDIA_NAME] ,\\n[MEDIA_TYPE] ,\\n[MEDIA_TYPE_Other] ,\\n[Medium] ,\\n[Onsite_Stations] ,\\n[Pass_Selection] ,\\n[Pavilion] ,\\n[PAY_Currency] ,\\n[PAY_Mode] ,\\n[PAY_Mode_Pack_2] ,\\n[PAY_Mode_Pack_3] ,\\n[PAY_Type] ,\\n[Payment_Channel] ,\\n[PAYMENT_CHOICE] ,\\n[PAYMENT_CHOICE_PACK_2] ,\\n[PAYMENT_CHOICE_PACK_3] ,\\n[PAYMENT_DETAILS] ,\\n[PAYMENT_DETAILS_PACK_2] ,\\n[PAYMENT_DETAILS_PACK_3] ,\\n[PAYMENT_STATUS] ,\\n[PAYMENT_STATUS_PACK_1] ,\\n[PAYMENT_STATUS_PACK_2] ,\\n[PAYMENT_STATUS_PACK_3] ,\\n[Pre_POP_Codes] ,\\n[Promo_Code] ,\\n[Promo_Code_Discount_Ticketing_Price] ,\\n[PS_Data] ,\\n[PUBL_FREQ] ,\\n[PUBL_FREQ_Other] ,\\n[Publication] ,\\n[Receipt_No] ,\\nCASE \\n        WHEN Reg_Date LIKE \\'%PM%\\' \\n        THEN CONVERT(DATETIME, REPLACE(Reg_Date, \\' PM\\', \\' PM\\'), 103) \\n          WHEN Reg_Date LIKE \\'%AM%\\' \\n        THEN CONVERT(DATETIME, REPLACE(Reg_Date, \\' AM\\', \\' AM\\'), 103) \\n          WHEN Reg_Date LIKE \\'%Z%\\' \\n        THEN CONVERT(DATETIME2, Reg_Date, 127) \\n        ELSE   COALESCE(TRY_CONVERT(DATETIME2, Reg_Date, 103) ,      TRY_CONVERT(DATETIME2, Reg_Date, 127), \\n          TRY_CONVERT(datetime, Reg_Date, 101))\\n    END AS Reg_Date  ,\\n[Reg_hall] ,\\n[Reg_hall_Other] ,\\n[Reg_Number] ,\\n[Reg_Type] ,\\n[Reg_Type_Other] ,\\n[Second_Booking_Paid_Packages] ,\\n[Self_Reg_Area] ,\\n[Sessions_Attendance] ,\\n[SHOW_NAME] ,\\n[Stand_Number] ,\\n[Student_ID] ,\\n[Terms_Conditions] ,\\n[Ticket_Selection] ,\\n[Upgrade] ,\\n[UTM_Values] ,\\n[Verticals_Session] ,\\n[VISITOR_TYPE] ,\\n[VISITOR_TYPE_Other] \\n\\n  FROM [ods].[EM_Visitors]\\n where  ([EventName] <> \\'DO NOT IMPORT\\' or [EventName] is null)\\n and  [FileName] NOT IN (\\n  SELECT [FileName]\\n  FROM [EM_DWH].[FACT_VISITOR_REGISTRATION]\\n  )\\n  group by \\n  [Index]+Filename \\n\\n,[Index]\\n,[EventName]\\n,[FileName]\\n,[2PM_Attendance] ,\\n[Attended] ,\\n[Badge_Type] ,\\n[Campaign] ,\\n[Campaign_Source] ,\\n[Cluster_Name] ,\\n[CONFERENCE_PACKAGE_FIRST_BOOKING] ,\\n[CONFERENCE_PACKAGE_SECOND_BOOKING] ,\\n[Conference_Package_Third_Booking] ,\\n[Cross_Over_Gates] ,\\n[Cross_Over_Overall_Day] ,\\n[Daily_Attendance] ,\\n[Day_Selection] ,\\n[DTCM_BASKETS] ,\\n[DWTC_Booking_Platform] ,\\n[DWTC_CRM_ID] ,\\n[Event_ID] ,\\n[Event_Year] ,\\n[Exhibition_Halls] ,\\n[Exhibition_Packages] ,\\n[Exhibitor_Promo_Codes] ,\\n[Exhibitor_Type] ,\\n[Exhibitor_Account_ID] ,\\n[Exhibitor_Name] ,\\n[Facial_Recognition] ,\\n[First_Booking_Paid_Packages] ,\\n[GATE_SCANNERS] ,\\n[Gates] ,\\n[Generic_Package_Code_Exhibition_Conference] ,\\n[ID_Verification] ,\\n[Personal_Data_Consent] ,\\n[Particulars_Given_Gov] ,\\n[Majlis_Management] ,\\n[Majlis_Nominating_Company] ,\\n[Media_Geographical_Distribution] ,\\n[MEDIA_LANGUAGE] ,\\n[MEDIA_NAME] ,\\n[MEDIA_TYPE] ,\\n[MEDIA_TYPE_Other] ,\\n[Medium] ,\\n[Onsite_Stations] ,\\n[Pass_Selection] ,\\n[Pavilion] ,\\n[PAY_Currency] ,\\n[PAY_Mode] ,\\n[PAY_Mode_Pack_2] ,\\n[PAY_Mode_Pack_3] ,\\n[PAY_Type] ,\\n[Payment_Channel] ,\\n[PAYMENT_CHOICE] ,\\n[PAYMENT_CHOICE_PACK_2] ,\\n[PAYMENT_CHOICE_PACK_3] ,\\n[PAYMENT_DETAILS] ,\\n[PAYMENT_DETAILS_PACK_2] ,\\n[PAYMENT_DETAILS_PACK_3] ,\\n[PAYMENT_STATUS] ,\\n[PAYMENT_STATUS_PACK_1] ,\\n[PAYMENT_STATUS_PACK_2] ,\\n[PAYMENT_STATUS_PACK_3] ,\\n[Pre_POP_Codes] ,\\n[Promo_Code] ,\\n[Promo_Code_Discount_Ticketing_Price] ,\\n[PS_Data] ,\\n[PUBL_FREQ] ,\\n[PUBL_FREQ_Other] ,\\n[Publication] ,\\n[Receipt_No] ,\\n CASE \\n        WHEN Reg_Date LIKE \\'%PM%\\' \\n        THEN CONVERT(DATETIME, REPLACE(Reg_Date, \\' PM\\', \\' PM\\'), 103) \\n          WHEN Reg_Date LIKE \\'%AM%\\' \\n        THEN CONVERT(DATETIME, REPLACE(Reg_Date, \\' AM\\', \\' AM\\'), 103) \\n          WHEN Reg_Date LIKE \\'%Z%\\' \\n        THEN CONVERT(DATETIME2, Reg_Date, 127) \\n        ELSE   COALESCE(TRY_CONVERT(DATETIME2, Reg_Date, 103) ,      TRY_CONVERT(DATETIME2, Reg_Date, 127), \\n          TRY_CONVERT(datetime, Reg_Date, 101))\\n    END ,\\n[Reg_hall] ,\\n[Reg_hall_Other] ,\\n[Reg_Number] ,\\n[Reg_Type] ,\\n[Reg_Type_Other] ,\\n[Second_Booking_Paid_Packages] ,\\n[Self_Reg_Area] ,\\n[Sessions_Attendance] ,\\n[SHOW_NAME] ,\\n[Stand_Number] ,\\n[Student_ID] ,\\n[Terms_Conditions] ,\\n[Ticket_Selection] ,\\n[Upgrade] ,\\n[UTM_Values] ,\\n[Verticals_Session] ,\\n[VISITOR_TYPE] ,\\n[VISITOR_TYPE_Other] \\n',",
                "     format: 'query',",
                "     staged: true) ~> source1",
                "source(output(",
                "          Question as string,",
                "          Answer as string,",
                "          {New Value} as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     ignoreNoFilesFound: false,",
                "     format: 'excel',",
                "     fileSystem: 'em-data',",
                "     folderPath: 'Input Files',",
                "     fileName: 'Value Mapping - Result.xlsx',",
                "     sheetName: 'NEW',",
                "     firstRowAsHeader: true) ~> source2",
                "source(output(",
                "          Event_ID as integer,",
                "          EventID as string,",
                "          EventName as string,",
                "          ShowName as string,",
                "          ShowName2 as string,",
                "          TypeID as long,",
                "          EventStatus as long,",
                "          EventStartDate as date,",
                "          ShellScheme as decimal(38,2),",
                "          SpecialStands as decimal(38,2),",
                "          OutdoorSpaceOnly as decimal(38,2),",
                "          SpaceOnlyAED as decimal(38,2),",
                "          ShellSchemeSqm as decimal(38,2),",
                "          SponsorshipAED as decimal(38,2),",
                "          CorporateDeck as decimal(38,2),",
                "          EventIDValue as string,",
                "          ClusterName as string,",
                "          Execution_Date as timestamp",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     isolationLevel: 'READ_UNCOMMITTED',",
                "     format: 'table',",
                "     staged: true) ~> DimEvent",
                "source(output(",
                "          Contact_ID as integer,",
                "          ID as string,",
                "          Index as string,",
                "          Event_ID as integer,",
                "          Country_ID as integer,",
                "          FileName as string,",
                "          Address_line_1 as string,",
                "          Address_line_2 as string,",
                "          Address_line_3 as string,",
                "          AGE as string,",
                "          {Bill_to-Address_line_1} as string,",
                "          {Bill_to-Address_line_2} as string,",
                "          {Bill_to-Address_line_3} as string,",
                "          {Bill_to-City_of_Company} as string,",
                "          {Bill_to-Company_Name} as string,",
                "          {Bill_to-Country} as string,",
                "          {Bill_to-Designation} as string,",
                "          {Bill_to-First_Name} as string,",
                "          {Bill_to-Last_Name} as string,",
                "          {Bill_to-P.O._Box} as string,",
                "          {Bill_to-Postal_Code} as string,",
                "          {Bill_to-State} as string,",
                "          City_of_Company as string,",
                "          Company_Facebook as string,",
                "          Company_Instagram as string,",
                "          Company_Linkedin as string,",
                "          CompanyName as string,",
                "          Company_Snapchat as string,",
                "          Company_Twitter as string,",
                "          Company_Website as string,",
                "          Company_Youtube as string,",
                "          Country as string,",
                "          Data_Source as string,",
                "          Department as string,",
                "          Department_Other as string,",
                "          Designation as string,",
                "          {[DesignationLevel]} as string,",
                "          Designation_Level_Other as string,",
                "          Email as string,",
                "          Email_1 as string,",
                "          Emirates_ID_Passport_No as string,",
                "          Fax_Number as string,",
                "          FirstName as string,",
                "          FullName as string,",
                "          Gender as string,",
                "          JobFunction as string,",
                "          LANGUAGE_COMM as string,",
                "          LastName as string,",
                "          Middle_Name as string,",
                "          MobilePhone as string,",
                "          Mobile_Number_1 as string,",
                "          Nationality as string,",
                "          {P.O_Box} as string,",
                "          Personal_Facebook as string,",
                "          Personal_Instagram as string,",
                "          Personal_LinkedIn as string,",
                "          Personal_Pinterest as string,",
                "          Personal_Snapchat as string,",
                "          Personal_Twitter as string,",
                "          Personal_YouTube as string,",
                "          Phone_Extn as string,",
                "          Phone_Number as string,",
                "          Phone_Number_1 as string,",
                "          Postal_Code as string,",
                "          Prefix as string,",
                "          Region as string,",
                "          Source as string,",
                "          State as string,",
                "          Type_of_Data as string,",
                "          UAE_Resedency_Emirate as string,",
                "          Reg_Date as timestamp,",
                "          Contact_GR_ID as integer,",
                "          Execution_Date as timestamp,",
                "          DesignationLevel as string,",
                "          GR_ID as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     isolationLevel: 'READ_UNCOMMITTED',",
                "     format: 'table',",
                "     staged: true) ~> DimContactReg",
                "source1, filter6 join(upper(Attended) == upper(Answer),",
                "     joinType:'left',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> join1",
                "select1, filter5 join(upper(Cluster_Name) == upper(Answer),",
                "     joinType:'left',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> join2",
                "source2 filter(Question=='VISITOR_TYPE') ~> filter2",
                "source2 filter(Question=='SHOW_NAME') ~> filter3",
                "source2 filter(Question=='Reg_Type') ~> filter4",
                "source2 filter(Question=='Cluster_Name') ~> filter5",
                "source2 filter(Question=='Attended') ~> filter6",
                "select2, filter4 join(upper(Reg_Type) == upper(Answer),",
                "     joinType:'left',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> join3",
                "select3, filter3 join(upper(SHOW_NAME) == upper(Answer),",
                "     joinType:'left',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> join4",
                "join1 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1 = {New Value}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select1",
                "join2 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1,",
                "          Cluster_Name1 = {New Value}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select2",
                "join3 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1,",
                "          Cluster_Name1,",
                "          Reg_Type1 = {New Value}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select3",
                "join4 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1,",
                "          Cluster_Name1,",
                "          Reg_Type1,",
                "          SHOW_NAME1 = {New Value}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select4",
                "select4, filter2 join(upper(VISITOR_TYPE) == upper(Answer),",
                "     joinType:'left',",
                "     matchType:'exact',",
                "     ignoreSpaces: false,",
                "     broadcast: 'auto')~> join5",
                "join5 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1,",
                "          Cluster_Name1,",
                "          Reg_Type1,",
                "          SHOW_NAME1,",
                "          VISITOR_TYPE1 = {New Value}",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select5",
                "select5 derive(Attended = iifNull(Attended1, Attended,Attended1),",
                "          Cluster_Name = iifNull(Cluster_Name1, Cluster_Name,Cluster_Name1),",
                "          Reg_Type = iifNull(Reg_Type1, Reg_Type,Reg_Type1),",
                "          SHOW_NAME = iifNull(SHOW_NAME1, SHOW_NAME,SHOW_NAME1),",
                "          VISITOR_TYPE = iifNull(VISITOR_TYPE1, VISITOR_TYPE,VISITOR_TYPE1)) ~> derivedColumn1",
                "derivedColumn1, DimEvent lookup(upper(select5@EventName) == upper(DimEvent@EventName),",
                "     multiple: false,",
                "     pickup: 'any',",
                "     broadcast: 'auto')~> lookup1",
                "lookup1 select(mapColumn(",
                "          id,",
                "          Index,",
                "          EventName = select5@EventName,",
                "          FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          EventID = select5@Event_ID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_Date,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Attended1,",
                "          Cluster_Name1,",
                "          Reg_Type1,",
                "          SHOW_NAME1,",
                "          VISITOR_TYPE1,",
                "          Event_ID = DimEvent@Event_ID,",
                "          EventStartDate",
                "     ),",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true) ~> select6",
                "select6 derive(Reg_Date = iifNull(Reg_Date, EventStartDate,Reg_Date),",
                "          Execution_Date = currentUTC(),",
                "          Badge_Type = split(Badge_Type, ',')) ~> derivedColumn2",
                "flatten1, DimContactReg lookup(upper(flatten1@id) == upper(DimContactReg@ID),",
                "     multiple: false,",
                "     pickup: 'any',",
                "     broadcast: 'auto')~> lookup2",
                "derivedColumn2 foldDown(unroll(Badge_Type),",
                "     mapColumn(",
                "          each(match(/* All input columns */true()),",
                "               /* Input name */$$ = $$)",
                "     ),",
                "     skipDuplicateMapInputs: false,",
                "     skipDuplicateMapOutputs: false) ~> flatten1",
                "lookup2 sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     input(",
                "          Contact_ID as integer,",
                "          ID as string,",
                "          Index as string,",
                "          Event_ID as integer,",
                "          FileName as string,",
                "          {2PM_Attendance} as string,",
                "          Attended as string,",
                "          Badge_Type as string,",
                "          Campaign as string,",
                "          Campaign_Source as string,",
                "          Cluster_Name as string,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING as string,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING as string,",
                "          Conference_Package_Third_Booking as string,",
                "          Cross_Over_Gates as string,",
                "          Cross_Over_Overall_Day as string,",
                "          Daily_Attendance as string,",
                "          Day_Selection as string,",
                "          DTCM_BASKETS as string,",
                "          DWTC_Booking_Platform as string,",
                "          DWTC_CRM_ID as string,",
                "          EventID as string,",
                "          Event_Year as string,",
                "          Exhibition_Halls as string,",
                "          Exhibition_Packages as string,",
                "          Exhibitor_Promo_Codes as string,",
                "          Exhibitor_Type as string,",
                "          Exhibitor_Account_ID as string,",
                "          Exhibitor_Name as string,",
                "          Facial_Recognition as string,",
                "          First_Booking_Paid_Packages as string,",
                "          GATE_SCANNERS as string,",
                "          Gates as string,",
                "          Generic_Package_Code_Exhibition_Conference as string,",
                "          ID_Verification as string,",
                "          Personal_Data_Consent as string,",
                "          Particulars_Given_Gov as string,",
                "          Majlis_Management as string,",
                "          Majlis_Nominating_Company as string,",
                "          Media_Geographical_Distribution as string,",
                "          MEDIA_LANGUAGE as string,",
                "          MEDIA_NAME as string,",
                "          MEDIA_TYPE as string,",
                "          MEDIA_TYPE_Other as string,",
                "          Medium as string,",
                "          Onsite_Stations as string,",
                "          Pass_Selection as string,",
                "          Pavilion as string,",
                "          PAY_Currency as string,",
                "          PAY_Mode as string,",
                "          PAY_Mode_Pack_2 as string,",
                "          PAY_Mode_Pack_3 as string,",
                "          PAY_Type as string,",
                "          Payment_Channel as string,",
                "          PAYMENT_CHOICE as string,",
                "          PAYMENT_CHOICE_PACK_2 as string,",
                "          PAYMENT_CHOICE_PACK_3 as string,",
                "          PAYMENT_DETAILS as string,",
                "          PAYMENT_DETAILS_PACK_2 as string,",
                "          PAYMENT_DETAILS_PACK_3 as string,",
                "          PAYMENT_STATUS as string,",
                "          PAYMENT_STATUS_PACK_1 as string,",
                "          PAYMENT_STATUS_PACK_2 as string,",
                "          PAYMENT_STATUS_PACK_3 as string,",
                "          Pre_POP_Codes as string,",
                "          Promo_Code as string,",
                "          Promo_Code_Discount_Ticketing_Price as string,",
                "          PS_Data as string,",
                "          PUBL_FREQ as string,",
                "          PUBL_FREQ_Other as string,",
                "          Publication as string,",
                "          Receipt_No as string,",
                "          Reg_hall as string,",
                "          Reg_hall_Other as string,",
                "          Reg_Number as string,",
                "          Reg_Type as string,",
                "          Reg_Type_Other as string,",
                "          Second_Booking_Paid_Packages as string,",
                "          Self_Reg_Area as string,",
                "          Sessions_Attendance as string,",
                "          SHOW_NAME as string,",
                "          Stand_Number as string,",
                "          Student_ID as string,",
                "          Terms_Conditions as string,",
                "          Ticket_Selection as string,",
                "          Upgrade as string,",
                "          UTM_Values as string,",
                "          Verticals_Session as string,",
                "          VISITOR_TYPE as string,",
                "          VISITOR_TYPE_Other as string,",
                "          Reg_Date as timestamp,",
                "          Execution_Date as timestamp,",
                "          Contact_GR_ID as integer",
                "     ),",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     format: 'table',",
                "     staged: true,",
                "     allowCopyCommand: true,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     errorHandlingOption: 'stopOnFirstError',",
                "     mapColumn(",
                "          Contact_ID,",
                "          ID = flatten1@id,",
                "          Index = flatten1@Index,",
                "          Event_ID = flatten1@Event_ID,",
                "          FileName = flatten1@FileName,",
                "          {2PM_Attendance},",
                "          Attended,",
                "          Badge_Type,",
                "          Campaign,",
                "          Campaign_Source,",
                "          Cluster_Name,",
                "          CONFERENCE_PACKAGE_FIRST_BOOKING,",
                "          CONFERENCE_PACKAGE_SECOND_BOOKING,",
                "          Conference_Package_Third_Booking,",
                "          Cross_Over_Gates,",
                "          Cross_Over_Overall_Day,",
                "          Daily_Attendance,",
                "          Day_Selection,",
                "          DTCM_BASKETS,",
                "          DWTC_Booking_Platform,",
                "          DWTC_CRM_ID,",
                "          EventID,",
                "          Event_Year,",
                "          Exhibition_Halls,",
                "          Exhibition_Packages,",
                "          Exhibitor_Promo_Codes,",
                "          Exhibitor_Type,",
                "          Exhibitor_Account_ID,",
                "          Exhibitor_Name,",
                "          Facial_Recognition,",
                "          First_Booking_Paid_Packages,",
                "          GATE_SCANNERS,",
                "          Gates,",
                "          Generic_Package_Code_Exhibition_Conference,",
                "          ID_Verification,",
                "          Personal_Data_Consent,",
                "          Particulars_Given_Gov,",
                "          Majlis_Management,",
                "          Majlis_Nominating_Company,",
                "          Media_Geographical_Distribution,",
                "          MEDIA_LANGUAGE,",
                "          MEDIA_NAME,",
                "          MEDIA_TYPE,",
                "          MEDIA_TYPE_Other,",
                "          Medium,",
                "          Onsite_Stations,",
                "          Pass_Selection,",
                "          Pavilion,",
                "          PAY_Currency,",
                "          PAY_Mode,",
                "          PAY_Mode_Pack_2,",
                "          PAY_Mode_Pack_3,",
                "          PAY_Type,",
                "          Payment_Channel,",
                "          PAYMENT_CHOICE,",
                "          PAYMENT_CHOICE_PACK_2,",
                "          PAYMENT_CHOICE_PACK_3,",
                "          PAYMENT_DETAILS,",
                "          PAYMENT_DETAILS_PACK_2,",
                "          PAYMENT_DETAILS_PACK_3,",
                "          PAYMENT_STATUS,",
                "          PAYMENT_STATUS_PACK_1,",
                "          PAYMENT_STATUS_PACK_2,",
                "          PAYMENT_STATUS_PACK_3,",
                "          Pre_POP_Codes,",
                "          Promo_Code,",
                "          Promo_Code_Discount_Ticketing_Price,",
                "          PS_Data,",
                "          PUBL_FREQ,",
                "          PUBL_FREQ_Other,",
                "          Publication,",
                "          Receipt_No,",
                "          Reg_hall,",
                "          Reg_hall_Other,",
                "          Reg_Number,",
                "          Reg_Type,",
                "          Reg_Type_Other,",
                "          Second_Booking_Paid_Packages,",
                "          Self_Reg_Area,",
                "          Sessions_Attendance,",
                "          SHOW_NAME,",
                "          Stand_Number,",
                "          Student_ID,",
                "          Terms_Conditions,",
                "          Ticket_Selection,",
                "          Upgrade,",
                "          UTM_Values,",
                "          Verticals_Session,",
                "          VISITOR_TYPE,",
                "          VISITOR_TYPE_Other,",
                "          Reg_Date = flatten1@Reg_Date,",
                "          Execution_Date = flatten1@Execution_Date,",
                "          Contact_GR_ID",
                "     )) ~> sink1"
            ]
        }
    }
}