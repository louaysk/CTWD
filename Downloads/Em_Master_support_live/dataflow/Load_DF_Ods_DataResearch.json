{
    "name": "Load_DF_Ods_DataResearch",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "Excel7",
                        "type": "DatasetReference"
                    },
                    "name": "source1"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "ODS_DataResearch",
                        "type": "DatasetReference"
                    },
                    "name": "sink1"
                }
            ],
            "transformations": [
                {
                    "name": "derivedColumn1"
                }
            ],
            "scriptLines": [
                "parameters{",
                "     FileName as string",
                "}",
                "source(output(",
                "          Research_ID as string,",
                "          {Project Name} as string,",
                "          {Company Name} as string,",
                "          {Company Type} as string,",
                "          {Industry Type} as string,",
                "          {Sub-Industry Type} as string,",
                "          Prefix as string,",
                "          {First Name} as string,",
                "          {Last Name} as string,",
                "          Designation as string,",
                "          {Email Address 1} as string,",
                "          {Email Address 2} as string,",
                "          {Phone Number} as string,",
                "          {Mobile Number} as string,",
                "          {P.O Box} as string,",
                "          {Address Line 1} as string,",
                "          {Address Line 2} as string,",
                "          City as string,",
                "          State as string,",
                "          {ZIP/Postal Code} as string,",
                "          Country as string,",
                "          Region as string,",
                "          {Research Date} as string",
                "     ),",
                "     allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     ignoreNoFilesFound: true,",
                "     wildcardPaths:['Landing Zone/Data Research/Data Research/*.xlsx']) ~> source1",
                "source1 derive(Execution_Date = currentUTC(),",
                "          {Research Date} = toDate({Research Date}),",
                "          Filename = $FileName) ~> derivedColumn1",
                "derivedColumn1 sink(allowSchemaDrift: true,",
                "     validateSchema: false,",
                "     input(",
                "          Research_ID as string,",
                "          ProjectName as string,",
                "          CompanyName as string,",
                "          CompanyType as string,",
                "          IndustryType as string,",
                "          {Sub-IndustryType} as string,",
                "          Prefix as string,",
                "          FirstName as string,",
                "          LastName as string,",
                "          Designation as string,",
                "          Email as string,",
                "          EmailAddress2 as string,",
                "          PhoneNumber as string,",
                "          MobilePhone as string,",
                "          {P.O_Box} as string,",
                "          Address_line_1 as string,",
                "          Address_line_2 as string,",
                "          City as string,",
                "          State as string,",
                "          ZIP_Postal_Code as string,",
                "          Country as string,",
                "          Region as string,",
                "          Website as string,",
                "          Research_Date as date,",
                "          Execution_Date as timestamp,",
                "          Filename as string",
                "     ),",
                "     deletable:false,",
                "     insertable:true,",
                "     updateable:false,",
                "     upsertable:false,",
                "     format: 'table',",
                "     staged: true,",
                "     allowCopyCommand: true,",
                "     skipDuplicateMapInputs: true,",
                "     skipDuplicateMapOutputs: true,",
                "     errorHandlingOption: 'stopOnFirstError',",
                "     mapColumn(",
                "          Research_ID,",
                "          ProjectName = {Project Name},",
                "          CompanyName = {Company Name},",
                "          CompanyType = {Company Type},",
                "          IndustryType = {Industry Type},",
                "          {Sub-IndustryType} = {Sub-Industry Type},",
                "          Prefix,",
                "          FirstName = {First Name},",
                "          LastName = {Last Name},",
                "          Designation,",
                "          Email = {Email Address 1},",
                "          EmailAddress2 = {Email Address 2},",
                "          PhoneNumber = {Phone Number},",
                "          MobilePhone = {Mobile Number},",
                "          {P.O_Box} = {P.O Box},",
                "          Address_line_1 = {Address Line 1},",
                "          Address_line_2 = {Address Line 2},",
                "          City,",
                "          State,",
                "          ZIP_Postal_Code = {ZIP/Postal Code},",
                "          Country,",
                "          Region,",
                "          Research_Date = {Research Date},",
                "          Execution_Date,",
                "          Filename",
                "     )) ~> sink1"
            ]
        }
    }
}